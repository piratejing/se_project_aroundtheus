!function(){"use strict";class e{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formEl=t}_showInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}_disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}toggleButtonState(){this._hasInvalidInput()?this._disableButton():this._enableButton()}_setEventListeners(){this._inputEls=[...this._formEl.querySelectorAll(this._inputSelector)],this._submitButton=this._formEl.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputEls.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}}class t{constructor(e,t){let{items:s,renderer:r}=e;this.items=s,this.renderer=r,this.container=document.querySelector(t)}renderItems(){this.items.forEach((e=>this.renderer(e)))}addItem(e){this.container.prepend(e)}}const s=document.querySelector("#profile-edit-button"),r=document.querySelector("#profile-edit-modal"),i=(document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-title-input")),o=document.querySelector("#profile-description-input"),n=(document.querySelector("#preview-image-modal"),document.querySelector(".modal__preview-image"),document.querySelector(".modal__preview-footer"),r.querySelector(".modal__form"),document.querySelector("#avatar-modal")),a=(document.querySelector("#avatar-modal-form"),document.querySelector(".profile__avatar-edit-btn")),l=(document.querySelector("#delete-card"),document.querySelector(".cards__list"),document.querySelector("#card-template").content.firstElementChild,document.querySelector(".profile__add-button")),d=document.querySelector("#card-edit-modal"),c=d.querySelector(".modal__form"),h=(d.querySelector(".modal__close-button"),c.querySelector("#card-title-input"),c.querySelector("#card-url-input"),{inputSelector:".modal__form-input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__form-input_error",errorClass:"modal__error_visible",cardSectionClass:".cards__list"});class u{constructor(e){let{popupSelector:t}=e;this._modalElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._modalElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modalElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){27===e.which&&this.close()}setEventListeners(){this._modalElement.addEventListener("mousedown",(e=>{this._closeModalOnRemoteClick(e)}))}_closeModalOnRemoteClick(e){(e.target===e.currentTarget||e.target.classList.contains("modal__close-button"))&&this.close()}}class _ extends u{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super({popupSelector:t}),this._form=this._modalElement.querySelector(".modal__form"),this._saveButton=this._modalElement.querySelector(".modal__submit-button"),this._handleFormSubmit=s}renderLoading(e,t){this._saveButton.textContent=e?"Saving...":t}_getInputValues(){const e=[...this._modalElement.querySelectorAll(".modal__form-input")],t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}close(){this._form.reset(),super.close()}}const m=new class{constructor(e){this.baseUrl=e.baseUrl,this.headers=e.headers}_processResponse=e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`);getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this.headers}).then(this._processResponse)}getUserInfo(){return fetch(`${this.baseUrl}/users/me`,{headers:this.headers}).then(this._processResponse)}updateProfileInfo(e){let{name:t,about:s}=e;return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:t,about:s})}).then(this._processResponse)}addCard(e){let{name:t,link:s}=e;return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify({name:t,link:s})}).then((e=>e.json()))}deleteCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers}).then(this._processResponse)}addLike(e){return fetch(`${this.baseUrl}/cards/likes/${e}`,{method:"PUT",headers:this.headers,body:JSON.stringify({cardId:e})}).then(this._processResponse)}removeLike(e){return fetch(`${this.baseUrl}/cards/likes/${e}`,{method:"DELETE",headers:this.headers,body:JSON.stringify({cardId:e})}).then(this._processResponse)}updateAvatar(e){return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this._processResponse)}getApiInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"647a8f04-5b88-450f-8780-5fd992cd87e1","Content-Type":"application/json"}}),p=r.querySelector(".modal__form"),v=d.querySelector(".modal__form"),E=n.querySelector(".modal__form"),S=new e(h,p);S.enableValidation();const f=new e(h,v);f.enableValidation();const b=new e(h,E);b.enableValidation();const L=new _({popupSelector:"#card-edit-modal",handleFormSubmit:function(e){L.renderLoading(!0),m.addCard({name:e.name,link:e.link}).then((e=>{B.addItem(q(e)),L.close()})).catch((e=>{console.log(e)})).finally((()=>{L.renderLoading(!1,"Create")}))}});L.setEventListeners();const g=new _({popupSelector:"#avatar-modal",handleFormSubmit:function(e){g.renderLoading(!0),m.updateAvatar(e.avatar).then((e=>{I.setAvatarInfo({avatar:e.avatar}),g.close()})).catch((e=>{console.log(e)})).finally((()=>{g.renderLoading(!1,"Save")}))}});g.setEventListeners();const y=new _({popupSelector:"#profile-edit-modal",handleFormSubmit:function(e){y.renderLoading(!0),m.updateProfileInfo({name:e.title,about:e.job}).then((e=>{I.setUserInfo({title:e.name,job:e.about}),y.close()})).catch((e=>{console.log(e)})).finally((()=>{y.renderLoading(!1,"Save")}))}});y.setEventListeners();const k=new class extends u{constructor(e){super({popupSelector:e}),this._modalImage=this._modalElement.querySelector(".modal__preview-image"),this._modalTitle=this._modalElement.querySelector(".modal__preview-footer")}open(e,t){super.open(),this._modalImage.src=e.src,this._modalImage.alt=e.alt,this._modalTitle.textContent=t.textContent}}("#preview-image-modal");k.setEventListeners();const C=new class extends u{constructor(e){super({popupSelector:e}),this._confirmButton=this._modalElement.querySelector("#delete-button")}setSubmitAction(e){this._handleSubmit=e}renderLoading(e,t){this._confirmButton.textContent=e?"Deleting...":t}setEventListeners(){super.setEventListeners(),this._confirmButton.addEventListener("click",(e=>{e.preventDefault(),this._handleSubmit()}))}}("#delete-card");C.setEventListeners();const I=new class{constructor(e){let{name:t,job:s,avatar:r}=e;this.name=document.querySelector(t),this.job=document.querySelector(s),this._avatar=document.querySelector(r)}getUserInfo(){return{name:this.name.textContent,job:this.job.textContent}}setUserInfo(e){let{title:t,job:s}=e;this.name.textContent=t,this.job.textContent=s}getAvatarInfo(){return this._avatar}setAvatarInfo(e){let{name:t,avatar:s}=e;this._avatar.src=s,this._avatar.alt=t}}({name:".profile__title",job:".profile__description",avatar:".profile__image"});function q(e){const t=new class{constructor(e,t,s,r,i,o){this._name=e.name,this._link=e.link,this._id=e._id,this._ownerId=e.owner._id,this._likes=e.likes,this._userId=t,this._cardSelector=s,this._handleCardClick=r,this._handleDeleteClick=i,this._handleLikeClick=o}getCardElement(){return this._cardElement=this._getView(),this._cardTitleEl=this._cardElement.querySelector(".card__title"),this._cardTitleEl.textContent=this._name,this._cardImageEl=this._cardElement.querySelector(".card__image"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardLikes=this._cardElement.querySelector(".card__likes-counter"),this._renderLikes(),this._userId!=this._ownerId&&this._deleteButton.remove(),this._setEventListeners(),this._cardElement}_setEventListeners(){this._cardImageEl.addEventListener("click",(()=>{this._handleCardClick(this._cardImageEl,this._cardTitleEl)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this._id)})),this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this._id)}))}deleteCard(){this._cardElement.remove(),this.cardElement=null}_addLikes(){this._likeButton.classList.add("card__like-button_active")}_removeLikes(){this._likeButton.classList.remove("card__like-button_active")}setLikes(e){this._likes=e,this._renderLikes()}isLiked(){return this._likes.some((e=>e._id===this._userId))}_renderLikes(){return this._cardLikes.textContent=this._likes.length,this.isLiked()?this._addLikes():this._removeLikes()}_getView(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}}(e,w,"#card-template",((e,t)=>{k.open(e,t)}),(e=>{C.open(),C.setSubmitAction((()=>{C.renderLoading(!0),m.deleteCard(e).then((()=>{t.deleteCard(),C.close()})).catch((e=>console.error(e))).finally((()=>{C.renderLoading(!1,"Yes")}))}))}),(e=>{t.isLiked()?m.removeLike(e).then((e=>{t.setLikes(e.likes)})).catch((e=>{console.log(e)})):m.addLike(e).then((e=>{t.setLikes(e.likes)})).catch((e=>{console.log(e)}))}));return t.getCardElement()}let B,w;s.addEventListener("click",(function(){const e=I.getUserInfo();i.value=e.name,o.value=e.job,y.open(),S.toggleButtonState()})),a.addEventListener("click",(()=>{b.toggleButtonState(),g.open()})),m.getApiInfo().then((e=>{let[s,r]=e;w=s._id,I.setUserInfo({title:s.name,job:s.about}),I.setAvatarInfo({avatar:s.avatar}),B=new t({items:r,renderer:e=>{B.addItem(q(e))}},".cards__list"),B.renderItems()})).catch((e=>{console.log(e)})),l.addEventListener("click",(()=>{L.open(),f.toggleButtonState()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUQsR0FDUmIsTUFBTVcsSUFDTGlELEVBQUs4QixTQUFTL0UsRUFBSzZELE1BQU0sSUFFMUIxQyxPQUFPQyxJQUNOQyxRQUFRQyxJQUFJRixFQUFJLEdBRXRCLElBR0osT0FBTzZCLEVBQUtrQixnQkFDZCxDQUVBLElBQUlsRCxFQUNBaUMsRUE3Rkp0SCxFQUFrQmhCLGlCQUFpQixTQVZuQyxXQUNFLE1BQU00SyxFQUFXL0QsRUFBU25DLGNBQzFCeEQsRUFBa0J3QyxNQUFRa0gsRUFBU25ILEtBQ25DdEMsRUFBd0J1QyxNQUFRa0gsRUFBUzNELElBRXpDRixFQUFVN0UsT0FFVitELEVBQWtCckcsbUJBQ3BCLElBcUJBeUIsRUFBYXJCLGlCQUFpQixTQUFTLEtBQ3JDbUcsRUFBb0J2RyxvQkFDcEJnSCxFQUFXMUUsTUFBTSxJQXlFbkIwQixFQUNHK0IsYUFDQWxCLE1BQUtsRSxJQUF1QixJQUFyQnFLLEVBQVVDLEdBQU10SyxFQUN0QitILEVBQVNzQyxFQUFTL0IsSUFDbEJoQyxFQUFTSyxZQUFZLENBQUVGLE1BQU80RCxFQUFTbkgsS0FBTXdELElBQUsyRCxFQUFTaEcsUUFDM0RpQyxFQUFTQyxjQUFjLENBQUVwQixPQUFRa0YsRUFBU2xGLFNBQzFDVyxFQUFjLElBQUkvRixFQUNoQixDQUNFRyxNQUFPb0ssRUFDUG5LLFNBQVcwSCxJQUNUL0IsRUFBWXZGLFFBQVF3RixFQUFXOEIsR0FBVSxHQUc3QyxnQkFFRi9CLEVBQVl6RixhQUFhLElBRTFCMkYsT0FBT29FLElBQ05sRSxRQUFRQyxJQUFJaUUsRUFBTSxJQXFCdEJySixFQUFjdEIsaUJBQWlCLFNBQVMsS0FDdENvRyxFQUFVbEUsT0FDVmdFLEVBQWlCdEcsbUJBQW1CLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9mb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9hcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmcsIGZvcm1FbCkge1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5nLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5nLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5nLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmcuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtRWwgPSBmb3JtRWw7XG4gIH1cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH1cbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dEVscy5ldmVyeSgoaW5wdXRFbCkgPT4gaW5wdXRFbC52YWxpZGl0eS52YWxpZCk7XG4gIH1cblxuICBfZGlzYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICB9XG5cbiAgX2VuYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZSkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWwuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfSk7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lcikge1xuICAgIHRoaXMuaXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lcik7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLml0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHRoaXMucmVuZGVyZXIoaXRlbSkpO1xuICB9XG5cbiAgYWRkSXRlbShpdGVtKSB7XG4gICAgdGhpcy5jb250YWluZXIucHJlcGVuZChpdGVtKTsgLy8gPC0tLSBhbmQgaGVyZSB3ZSBtYWtlIGEgcHJlcGVuZFxuICB9XG59XG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NpbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBmaSBCcmFpZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiKTtcblxuZXhwb3J0IGNvbnN0IHByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1pbWFnZS1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19wcmV2aWV3LWltYWdlXCIpO1xuZXhwb3J0IGNvbnN0IHByZXZpZXdGb290ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19wcmV2aWV3LWZvb3RlclwiKTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IGF2YXRhck1vZGFsRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsLWZvcm1cIik7XG5leHBvcnQgY29uc3QgYXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItZWRpdC1idG5cIik7XG5leHBvcnQgY29uc3QgZGVsZXRlQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLWNhcmRcIik7XG5cbmV4cG9ydCBjb25zdCBjYXJkTGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGNhcmRFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtZWRpdC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybSA9IGNhcmRFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBjYXJkTW9kYWxDbG9zZUJ1dHRvbiA9IGNhcmRFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xuXG5leHBvcnQgY29uc3QgY2FyZFRpdGxlSW5wdXQgPSBhZGRDYXJkRm9ybS5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGl0bGUtaW5wdXRcIik7XG5leHBvcnQgY29uc3QgY2FyZFVybElucHV0ID0gYWRkQ2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcIiNjYXJkLXVybC1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBFU0NfS0VZQ09ERSA9IDI3O1xuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybS1pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2Zvcm0taW5wdXRfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxuICBjYXJkU2VjdGlvbkNsYXNzOiBcIi5jYXJkc19fbGlzdFwiLFxufTtcbiIsImltcG9ydCB7IEVTQ19LRVlDT0RFIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50XCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuICBvcGVuKCkge1xuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQud2hpY2ggPT09IEVTQ19LRVlDT0RFKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX21vZGFsRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcbiAgICAgIHRoaXMuX2Nsb3NlTW9kYWxPblJlbW90ZUNsaWNrKGV2dCk7XG4gICAgfSk7XG4gIH1cbiAgX2Nsb3NlTW9kYWxPblJlbW90ZUNsaWNrKGV2dCkge1xuICAgIGlmIChldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldCB8fCBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZS1idXR0b25cIikpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5fc2F2ZUJ1dHRvbiA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIpO1xuXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgc2F2ZUJ1dHRvblRleHQpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zYXZlQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IHNhdmVCdXR0b25UZXh0O1xuICAgIH1cbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dHMgPSBbLi4udGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Zvcm0taW5wdXRcIildO1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG4gICAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxufVxuIiwiaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9hcGkuanNcIjtcblxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvZm9ybVZhbGlkYXRvci5qc1wiO1xuXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb25cIjtcbmltcG9ydCB7XG4gIGluaXRpYWxDYXJkcyxcbiAgcHJvZmlsZUVkaXRCdXR0b24sXG4gIHByb2ZpbGVFZGl0TW9kYWwsXG4gIHByb2ZpbGVUaXRsZSxcbiAgcHJvZmlsZURlc2NyaXB0aW9uLFxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCxcbiAgcHJvZmlsZVRpdGxlSW5wdXQsXG4gIHByb2ZpbGVFZGl0Rm9ybSxcbiAgcHJldmlld01vZGFsLFxuICBwcmV2aWV3SW1hZ2UsXG4gIHByZXZpZXdGb290ZXIsXG4gIGNhcmRMaXN0RWwsXG4gIGNhcmRUZW1wbGF0ZSxcbiAgYWRkQ2FyZEJ1dHRvbixcbiAgY2FyZEVkaXRNb2RhbCxcbiAgYXZhdGFyTW9kYWwsXG4gIGF2YXRhckJ1dHRvbixcbiAgZGVsZXRlQ2FyZCxcbiAgYXZhdGFyTW9kYWxGb3JtLFxuICBjYXJkTW9kYWxDbG9zZUJ1dHRvbixcbiAgY2FyZFRpdGxlSW5wdXQsXG4gIGNhcmRVcmxJbnB1dCxcbiAgY29uZmlnLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRcIjtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCI2NDdhOGYwNC01Yjg4LTQ1MGYtODc4MC01ZmQ5OTJjZDg3ZTFcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5jb25zdCBlZGl0Rm9ybUVsZW1lbnQgPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBhZGRGb3JtRWxlbWVudCA9IGNhcmRFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGF2YXRhckZvcm1FbCA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5cbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBlZGl0Rm9ybUVsZW1lbnQpO1xuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgYWRkRm9ybUVsZW1lbnQpO1xuXG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmNvbnN0IGF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGF2YXRhckZvcm1FbCk7XG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgY2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBwb3B1cFNlbGVjdG9yOiBcIiNjYXJkLWVkaXQtbW9kYWxcIixcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlQ2FyZEZvcm1TdWJtaXQsXG59KTtcblxuY2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGVkaXRBdmF0YXIgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IFwiI2F2YXRhci1tb2RhbFwiLFxuICBoYW5kbGVGb3JtU3VibWl0OiBoYW5kbGVBdmF0YXJGb3JtU3VibWl0LFxufSk7XG5lZGl0QXZhdGFyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3RvcjogXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IGhhbmRsZVByb2ZpbGVTdWJtaXQsXG59KTtcblxuZWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5jb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIik7XG5wb3B1cEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGRlbGV0ZUNhcmRNb2RhbCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXCIjZGVsZXRlLWNhcmRcIik7XG5cbmRlbGV0ZUNhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIG5hbWU6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXG4gIGpvYjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgYXZhdGFyOiBcIi5wcm9maWxlX19pbWFnZVwiLFxufSk7XG5mdW5jdGlvbiBoYW5kbGVFZGl0UHJvZmlsZSgpIHtcbiAgY29uc3QgdXNlckRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBwcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlckRhdGEuam9iO1xuXG4gIGVkaXRQb3B1cC5vcGVuKCk7XG5cbiAgZWRpdEZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbn1cblxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUVkaXRQcm9maWxlKTtcblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdChkYXRhKSB7XG4gIGVkaXRBdmF0YXIucmVuZGVyTG9hZGluZyh0cnVlKTtcblxuICBhcGlcbiAgICAudXBkYXRlQXZhdGFyKGRhdGEuYXZhdGFyKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldEF2YXRhckluZm8oeyBhdmF0YXI6IHJlcy5hdmF0YXIgfSk7XG5cbiAgICAgIGVkaXRBdmF0YXIuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgZWRpdEF2YXRhci5yZW5kZXJMb2FkaW5nKGZhbHNlLCBcIlNhdmVcIik7XG4gICAgfSk7XG59XG5hdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYXZhdGFyRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICBlZGl0QXZhdGFyLm9wZW4oKTtcbn0pO1xuXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlU3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIGVkaXRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuXG4gIGFwaVxuICAgIC51cGRhdGVQcm9maWxlSW5mbyh7IG5hbWU6IGlucHV0VmFsdWVzLnRpdGxlLCBhYm91dDogaW5wdXRWYWx1ZXMuam9iIH0pXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHsgdGl0bGU6IGRhdGEubmFtZSwgam9iOiBkYXRhLmFib3V0IH0pO1xuICAgICAgZWRpdFBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGVkaXRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlLCBcIlNhdmVcIik7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIGNhcmREYXRhLFxuICAgIHVzZXJJZCxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgKGNhcmROYW1lLCBjYXJkTGluaykgPT4ge1xuICAgICAgcG9wdXBJbWFnZS5vcGVuKGNhcmROYW1lLCBjYXJkTGluayk7XG4gICAgfSxcblxuICAgIChjYXJkSWQpID0+IHtcbiAgICAgIGRlbGV0ZUNhcmRNb2RhbC5vcGVuKCk7XG4gICAgICBkZWxldGVDYXJkTW9kYWwuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcbiAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgICAgIGFwaVxuICAgICAgICAgIC5kZWxldGVDYXJkKGNhcmRJZClcbiAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcbiAgICAgICAgICAgIGRlbGV0ZUNhcmRNb2RhbC5jbG9zZSgpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSlcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgICBkZWxldGVDYXJkTW9kYWwucmVuZGVyTG9hZGluZyhmYWxzZSwgXCJZZXNcIik7XG4gICAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgKGNhcmRJZCkgPT4ge1xuICAgICAgaWYgKGNhcmQuaXNMaWtlZCgpKSB7XG4gICAgICAgIGFwaVxuICAgICAgICAgIC5yZW1vdmVMaWtlKGNhcmRJZClcbiAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgY2FyZC5zZXRMaWtlcyhkYXRhLmxpa2VzKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLmFkZExpa2UoY2FyZElkKVxuICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICBjYXJkLnNldExpa2VzKGRhdGEubGlrZXMpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICApO1xuICByZXR1cm4gY2FyZC5nZXRDYXJkRWxlbWVudCgpO1xufVxuXG5sZXQgY2FyZFNlY3Rpb247XG5sZXQgdXNlcklkO1xuYXBpXG4gIC5nZXRBcGlJbmZvKClcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNdKSA9PiB7XG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHsgdGl0bGU6IHVzZXJEYXRhLm5hbWUsIGpvYjogdXNlckRhdGEuYWJvdXQgfSk7XG4gICAgdXNlckluZm8uc2V0QXZhdGFySW5mbyh7IGF2YXRhcjogdXNlckRhdGEuYXZhdGFyIH0pO1xuICAgIGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAgICB7XG4gICAgICAgIGl0ZW1zOiBjYXJkcyxcbiAgICAgICAgcmVuZGVyZXI6IChjYXJkRGF0YSkgPT4ge1xuICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChjYXJkRGF0YSkpO1xuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIFwiLmNhcmRzX19saXN0XCJcbiAgICApO1xuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gIH0pO1xuXG5mdW5jdGlvbiBoYW5kbGVDYXJkRm9ybVN1Ym1pdChpbnB1dFZhbHVlcykge1xuICBjYXJkUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcblxuICBhcGlcbiAgICAuYWRkQ2FyZCh7IG5hbWU6IGlucHV0VmFsdWVzLm5hbWUsIGxpbms6IGlucHV0VmFsdWVzLmxpbmsgfSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKGRhdGEpKTtcblxuICAgICAgY2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGNhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlLCBcIkNyZWF0ZVwiKTtcbiAgICB9KTtcbn1cblxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjYXJkUG9wdXAub3BlbigpO1xuICBhZGRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG59KTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLmJhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XG4gICAgdGhpcy5oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xuICB9XG5cbiAgX3Byb2Nlc3NSZXNwb25zZSA9IChyZXMpID0+IHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9O1xuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSk7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSk7XG4gIH1cblxuICB1cGRhdGVQcm9maWxlSW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBhYm91dCxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcbiAgfVxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbigoZGF0YSkgPT4gZGF0YS5qc29uKCkpO1xuICB9XG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcbiAgfVxuICBhZGRMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgY2FyZElkLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9wcm9jZXNzUmVzcG9uc2UpO1xuICB9XG4gIHJlbW92ZUxpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBjYXJkSWQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSk7XG4gIH1cbiAgdXBkYXRlQXZhdGFyKGF2YXRhcikge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXIsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSk7XG4gIH1cbiAgZ2V0QXBpSW5mbygpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckluZm8oKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG5cbiAgICB0aGlzLl9tb2RhbEltYWdlID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIik7XG4gICAgdGhpcy5fbW9kYWxUaXRsZSA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19wcmV2aWV3LWZvb3RlclwiKTtcbiAgfVxuICBvcGVuKGNhcmRJbWFnZUVsLCBjYXJkVGl0bGVFbCkge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgICB0aGlzLl9tb2RhbEltYWdlLnNyYyA9IGNhcmRJbWFnZUVsLnNyYztcbiAgICB0aGlzLl9tb2RhbEltYWdlLmFsdCA9IGNhcmRJbWFnZUVsLmFsdDtcbiAgICB0aGlzLl9tb2RhbFRpdGxlLnRleHRDb250ZW50ID0gY2FyZFRpdGxlRWwudGV4dENvbnRlbnQ7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbiA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1idXR0b25cIik7XG4gIH1cblxuICBzZXRTdWJtaXRBY3Rpb24oYWN0aW9uKSB7XG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gYWN0aW9uO1xuICB9XG5cbiAgcmVuZGVyTG9hZGluZyhpc0RlbGV0aW5nLCB0ZXh0KSB7XG4gICAgaWYgKGlzRGVsZXRpbmcpIHtcbiAgICAgIHRoaXMuX2NvbmZpcm1CdXR0b24udGV4dENvbnRlbnQgPSBcIkRlbGV0aW5nLi4uXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2NvbmZpcm1CdXR0b24udGV4dENvbnRlbnQgPSB0ZXh0O1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgam9iLCBhdmF0YXIgfSkge1xuICAgIHRoaXMubmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZSk7XG4gICAgdGhpcy5qb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYik7XG4gICAgdGhpcy5fYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXIpO1xuICB9XG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7IG5hbWU6IHRoaXMubmFtZS50ZXh0Q29udGVudCwgam9iOiB0aGlzLmpvYi50ZXh0Q29udGVudCB9O1xuICB9XG4gIHNldFVzZXJJbmZvKHsgdGl0bGUsIGpvYiB9KSB7XG4gICAgdGhpcy5uYW1lLnRleHRDb250ZW50ID0gdGl0bGU7XG4gICAgdGhpcy5qb2IudGV4dENvbnRlbnQgPSBqb2I7XG4gIH1cbiAgZ2V0QXZhdGFySW5mbygpIHtcbiAgICByZXR1cm4gdGhpcy5fYXZhdGFyO1xuICB9XG4gIHNldEF2YXRhckluZm8oeyBuYW1lLCBhdmF0YXIgfSkge1xuICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXI7XG4gICAgdGhpcy5fYXZhdGFyLmFsdCA9IG5hbWU7XG4gIH1cbn1cbiIsImNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCB1c2VySWQsIGNhcmRTZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVEZWxldGVDbGljaywgaGFuZGxlTGlrZUNsaWNrKSB7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcbiAgfVxuXG4gIGdldENhcmRFbGVtZW50KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VmlldygpO1xuXG4gICAgdGhpcy5fY2FyZFRpdGxlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZUVsLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xuXG4gICAgdGhpcy5fY2FyZExpa2VzID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlcy1jb3VudGVyXCIpO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG5cbiAgICBpZiAodGhpcy5fdXNlcklkICE9IHRoaXMuX293bmVySWQpIHtcbiAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5yZW1vdmUoKTtcbiAgICB9XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9jYXJkSW1hZ2VFbCwgdGhpcy5fY2FyZFRpdGxlRWwpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzLl9pZCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcy5faWQpO1xuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLmNhcmRFbGVtZW50ID0gbnVsbDtcbiAgfVxuXG4gIF9hZGRMaWtlcygpIHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gIH1cblxuICBfcmVtb3ZlTGlrZXMoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICB9XG5cbiAgc2V0TGlrZXMobGlrZXMpIHtcbiAgICB0aGlzLl9saWtlcyA9IGxpa2VzO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gIH1cblxuICBpc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcbiAgfVxuXG4gIF9yZW5kZXJMaWtlcygpIHtcbiAgICB0aGlzLl9jYXJkTGlrZXMudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG5cbiAgICBpZiAodGhpcy5pc0xpa2VkKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9hZGRMaWtlcygpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5fcmVtb3ZlTGlrZXMoKTtcbiAgICB9XG4gIH1cblxuICBfZ2V0VmlldygpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpLmNsb25lTm9kZSh0cnVlKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xuIl0sIm5hbWVzIjpbIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsInNldHRpbmciLCJmb3JtRWwiLCJ0aGlzIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRFbHMiLCJldmVyeSIsIl9kaXNhYmxlQnV0dG9uIiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiX2VuYWJsZUJ1dHRvbiIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIlNlY3Rpb24iLCJfcmVmIiwiY29udGFpbmVyIiwiaXRlbXMiLCJyZW5kZXJlciIsImRvY3VtZW50IiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsInByZXBlbmQiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVFZGl0TW9kYWwiLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwiYXZhdGFyTW9kYWwiLCJhdmF0YXJCdXR0b24iLCJhZGRDYXJkQnV0dG9uIiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2FyZEVkaXRNb2RhbCIsImFkZENhcmRGb3JtIiwiY29uZmlnIiwiY2FyZFNlY3Rpb25DbGFzcyIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9tb2RhbEVsZW1lbnQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsIndoaWNoIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2xvc2VNb2RhbE9uUmVtb3RlQ2xpY2siLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2Zvcm0iLCJfc2F2ZUJ1dHRvbiIsIl9oYW5kbGVGb3JtU3VibWl0IiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsInNhdmVCdXR0b25UZXh0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRzIiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsIm5hbWUiLCJ2YWx1ZSIsInJlc2V0IiwiYXBpIiwib3B0aW9ucyIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX3Byb2Nlc3NSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJnZXRVc2VySW5mbyIsInVwZGF0ZVByb2ZpbGVJbmZvIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZENhcmQiLCJfcmVmMiIsImxpbmsiLCJkYXRhIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwidXBkYXRlQXZhdGFyIiwiYXZhdGFyIiwiZ2V0QXBpSW5mbyIsImFsbCIsImF1dGhvcml6YXRpb24iLCJlZGl0Rm9ybUVsZW1lbnQiLCJhZGRGb3JtRWxlbWVudCIsImF2YXRhckZvcm1FbCIsImVkaXRGb3JtVmFsaWRhdG9yIiwiYWRkRm9ybVZhbGlkYXRvciIsImF2YXRhckZvcm1WYWxpZGF0b3IiLCJjYXJkUG9wdXAiLCJjYXJkU2VjdGlvbiIsImNyZWF0ZUNhcmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJmaW5hbGx5IiwiZWRpdEF2YXRhciIsInVzZXJJbmZvIiwic2V0QXZhdGFySW5mbyIsImVkaXRQb3B1cCIsInRpdGxlIiwiam9iIiwic2V0VXNlckluZm8iLCJwb3B1cEltYWdlIiwiX21vZGFsSW1hZ2UiLCJfbW9kYWxUaXRsZSIsImNhcmRJbWFnZUVsIiwiY2FyZFRpdGxlRWwiLCJzcmMiLCJhbHQiLCJkZWxldGVDYXJkTW9kYWwiLCJfY29uZmlybUJ1dHRvbiIsInNldFN1Ym1pdEFjdGlvbiIsImFjdGlvbiIsIl9oYW5kbGVTdWJtaXQiLCJpc0RlbGV0aW5nIiwidGV4dCIsIl9hdmF0YXIiLCJnZXRBdmF0YXJJbmZvIiwiX3JlZjMiLCJjYXJkRGF0YSIsImNhcmQiLCJ1c2VySWQiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsIl9uYW1lIiwiX2xpbmsiLCJfaWQiLCJfb3duZXJJZCIsIm93bmVyIiwiX2xpa2VzIiwibGlrZXMiLCJfdXNlcklkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfaGFuZGxlTGlrZUNsaWNrIiwiZ2V0Q2FyZEVsZW1lbnQiLCJfY2FyZEVsZW1lbnQiLCJfZ2V0VmlldyIsIl9jYXJkVGl0bGVFbCIsIl9jYXJkSW1hZ2VFbCIsIl9saWtlQnV0dG9uIiwiX2RlbGV0ZUJ1dHRvbiIsIl9jYXJkTGlrZXMiLCJfcmVuZGVyTGlrZXMiLCJjYXJkRWxlbWVudCIsIl9hZGRMaWtlcyIsIl9yZW1vdmVMaWtlcyIsInNldExpa2VzIiwiaXNMaWtlZCIsInNvbWUiLCJsaWtlIiwibGVuZ3RoIiwiY2xvbmVOb2RlIiwiY2FyZE5hbWUiLCJjYXJkTGluayIsImVycm9yIiwidXNlckRhdGEiLCJjYXJkcyJdLCJzb3VyY2VSb290IjoiIn0=